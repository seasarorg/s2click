$form

<div id="result">
</div>
<hr>
$button
<div id="target">
</div>

<div id="ajax_indicator" style="position:absolute; bottom:0; right:0; display:none;">
  <img src="$context/ajax-indicator.gif">
  通信中...
</div>

<script type="text/javascript">
/**
 * 取得した結果をクリアします。
 */
function clearResult(){
  $('result').innerHTML = '';
}

/**
 * 取得したJSONをテーブルで表示するためのコールバック関数
 */
function displayResult(req){
  var data = req.responseText.evalJSON();
  var html = '<table border="1">';
  html += '<tr><th>書籍名</th><th>出版社</th><th>価格</th><th>著者</th></tr>';
  for(var i=0;i<data.length;i++){
    html += '<tr>';
    html += '<td>' + data[i].title.escapeHTML() + '</td>';
    html += '<td>' + data[i].publisher.escapeHTML() + '</td>';
    html += '<td>' + data[i].price + '</td>';
    html += '<td>' + data[i].author.escapeHTML() + '</td>';
    html += '</tr>';
  }
  html += '</html>';
  $('result').innerHTML = html;

  stopProgress();
}

function startProgress(){
	$('ajax_indicator').style.display = '';
}

function stopProgress(){
	$('ajax_indicator').style.display = 'none';
}
</script>
